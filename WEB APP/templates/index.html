{% extends "base.html" %}

{% block title %}{{ t('site.title') }} - {{ t('site.description') }}{% endblock %}

{% block content %}
<!-- HERO SECTION MODERNE -->
<section class="hero-section animate-fade-in-up">
    <div class="container">
        <div class="row justify-content-center text-center">
            <div class="col-lg-10 col-xl-8">
                <h1 class="hero-title">
                    {{ t('home.hero_title') }}
                </h1>
                <p class="hero-subtitle">
                    {{ t('home.hero_subtitle') }}
                </p>
                <div class="d-flex flex-column flex-sm-row justify-content-center gap-3 mt-4">
                    {% if current_user.is_authenticated %}
                        <a href="{{ url_for('upload_files') }}" class="btn btn-primary btn-lg">
                            <i class="fas fa-rocket me-2"></i>
                            {{ t('home.hero_cta') }}
                        </a>
                    {% else %}
                        <a href="{{ url_for('upload_files') }}" class="btn btn-primary btn-lg">
                            <i class="fas fa-file-upload me-2"></i>
                            {{ t('nav.upload_files') }}
                        </a>
                    {% endif %}
                    <button class="btn btn-outline-primary btn-lg" data-bs-toggle="modal" data-bs-target="#demoModal" style="color: white !important; border-color: white !important; background-color: transparent !important;">
                        <i class="fas fa-play me-2" style="color: white !important;"></i>
                        <span style="color: white !important;">Voir la démo</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- STATISTIQUES RAPIDES -->
<section class="container my-5">
    <div class="stats-grid">
        <div class="stat-card animate-fade-in-up">
            <div class="stat-number">15K+</div>
            <div class="stat-label">Trades analysés</div>
        </div>
        <div class="stat-card animate-fade-in-up">
            <div class="stat-number">99.9%</div>
            <div class="stat-label">Précision</div>
        </div>
        <div class="stat-card animate-fade-in-up">
            <div class="stat-number">&lt; 30s</div>
            <div class="stat-label">Temps d'analyse</div>
        </div>
        <div class="stat-card animate-fade-in-up">
            <div class="stat-number">24/7</div>
            <div class="stat-label">Disponibilité</div>
        </div>
    </div>
</section>

<!-- FONCTIONNALITÉS PRINCIPALES -->
<section class="container my-5">
    <div class="row justify-content-center mb-5">
        <div class="col-lg-8 text-center">
            <h2 class="display-6 fw-bold mb-3">
                <i class="fas fa-star text-warning me-2"></i>
                {{ t('home.features_title') }}
            </h2>
            <p class="lead text-muted">
                Découvrez tous les outils dont vous avez besoin pour analyser et optimiser vos performances de trading
            </p>
        </div>
    </div>
    
    <div class="features-grid">
        <div class="feature-card animate-fade-in-up">
            <div class="feature-icon">
                <i class="fas fa-coins"></i>
            </div>
            <h3 class="feature-title">{{ t('home.feature_1_title') }}</h3>
            <p class="feature-text">
                {{ t('home.feature_1_desc') }}
            </p>
            <ul class="list-unstyled mt-3">
                <li><i class="fas fa-check text-success me-2"></i>Calculs en points/pips</li>
                <li><i class="fas fa-check text-success me-2"></i>Intérêts composés</li>
                <li><i class="fas fa-check text-success me-2"></i>Analyse du drawdown</li>
            </ul>
        </div>
        
        <div class="feature-card animate-fade-in-up">
            <div class="feature-icon">
                <i class="fas fa-chart-bar"></i>
            </div>
            <h3 class="feature-title">{{ t('home.feature_2_title') }}</h3>
            <p class="feature-text">
                {{ t('home.feature_2_desc') }}
            </p>
            <ul class="list-unstyled mt-3">
                <li><i class="fas fa-check text-success me-2"></i>Indices boursiers</li>
                <li><i class="fas fa-check text-success me-2"></i>Métaux précieux</li>
                <li><i class="fas fa-check text-success me-2"></i>Crypto-monnaies</li>
            </ul>
        </div>
        
        <div class="feature-card animate-fade-in-up">
            <div class="feature-icon">
                <i class="fas fa-file-excel"></i>
            </div>
            <h3 class="feature-title">{{ t('home.feature_3_title') }}</h3>
            <p class="feature-text">
                {{ t('home.feature_3_desc') }}
            </p>
            <ul class="list-unstyled mt-3">
                <li><i class="fas fa-check text-success me-2"></i>Graphiques interactifs</li>
                <li><i class="fas fa-check text-success me-2"></i>Statistiques détaillées</li>
                <li><i class="fas fa-check text-success me-2"></i>Export professionnel</li>
            </ul>
        </div>
        
        <div class="feature-card animate-fade-in-up">
            <div class="feature-icon">
                <i class="fas fa-file-excel"></i>
            </div>
            <h3 class="feature-title">{{ t('home.feature_4_title') }}</h3>
            <p class="feature-text">
                {{ t('home.feature_4_desc') }}
            </p>
            <ul class="list-unstyled mt-3">
                <li><i class="fas fa-check text-success me-2"></i>Graphiques interactifs</li>
                <li><i class="fas fa-check text-success me-2"></i>Statistiques détaillées</li>
                <li><i class="fas fa-check text-success me-2"></i>Export professionnel</li>
            </ul>
        </div>
    </div>
</section>

<!-- PROCESSUS SIMPLE -->
<section class="container my-5">
    <div class="row justify-content-center mb-5">
        <div class="col-lg-8 text-center">
            <h2 class="display-6 fw-bold mb-3">
                <i class="fas fa-cogs text-primary me-2"></i>
                Comment ça marche ?
            </h2>
            <p class="lead text-muted">
                Un processus simple et efficace en 3 étapes pour analyser vos données de trading
            </p>
        </div>
    </div>
    
    {% if not current_user.is_authenticated %}
    <!-- Section pour utilisateurs non connectés -->
    <div class="alert alert-info text-center mx-auto mb-5" style="max-width: 600px; border-radius: 20px; border: none; background: linear-gradient(135deg, #e3f2fd, #bbdefb);">
        <i class="fas fa-info-circle fa-2x text-primary mb-3"></i>
        <h5 class="fw-bold text-primary">Analyse disponible pour les membres</h5>
        <p class="mb-3 text-muted">
            Pour utiliser notre outil d'analyse professionnel, vous devez créer un compte gratuit. 
            Profitez de 10 analyses gratuites chaque mois !
        </p>
        <div class="d-flex justify-content-center gap-2 flex-wrap">
            <a href="{{ url_for('upload_files') }}" class="btn btn-info">
                <i class="fas fa-eye me-1"></i>Aperçu de l'outil
            </a>
            <a href="{{ url_for('auth.register') }}" class="btn btn-primary">
                <i class="fas fa-user-plus me-1"></i>Créer un compte
            </a>
            <a href="{{ url_for('auth.login') }}" class="btn btn-outline-primary">
                <i class="fas fa-sign-in-alt me-1"></i>Se connecter
            </a>
        </div>
    </div>
    {% endif %}
    
    <div class="process-grid">
        <div class="process-step animate-fade-in-up">
            <div class="step-number">1</div>
            <h4 class="step-title">Téléchargez vos fichiers</h4>
            <p class="step-text">
                Importez simplement vos fichiers Excel de trading. 
                Notre système supporte les formats MT4/MT5 et autres plateformes.
            </p>
        </div>
        
        <div class="process-step animate-fade-in-up">
            <div class="step-number">2</div>
            <h4 class="step-title">Analyse automatique</h4>
            <p class="step-text">
                Notre intelligence artificielle traite vos données automatiquement, 
                calcule les métriques et génère les analyses en quelques secondes.
            </p>
        </div>
        
        <div class="process-step animate-fade-in-up">
            <div class="step-number">3</div>
            <h4 class="step-title">Téléchargez votre rapport</h4>
            <p class="step-text">
                Recevez un rapport Excel complet avec toutes les statistiques, 
                graphiques et recommandations pour optimiser vos performances.
            </p>
        </div>
    </div>
</section>

<!-- EXEMPLES DE MÉTRIQUES -->
<section class="container my-5">
    <div class="row justify-content-center mb-5">
        <div class="col-lg-8 text-center">
            <h2 class="display-6 fw-bold mb-3">
                <i class="fas fa-chart-line text-info me-2"></i>
                Métriques Analysées
            </h2>
            <p class="lead text-muted">
                Obtenez une vue d'ensemble complète de vos performances avec nos métriques avancées
            </p>
        </div>
    </div>
    
    <div class="row g-4">
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 text-center p-3">
                <div class="card-body">
                    <i class="fas fa-trophy fa-3x text-warning mb-3"></i>
                    <h5 class="card-title">Taux de réussite</h5>
                    <p class="card-text text-muted">
                        Pourcentage de trades gagnants vs perdants
                    </p>
                </div>
            </div>
        </div>
        
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 text-center p-3">
                <div class="card-body">
                    <i class="fas fa-arrow-trend-up fa-3x text-success mb-3"></i>
                    <h5 class="card-title">Profit Factor</h5>
                    <p class="card-text text-muted">
                        Ratio gains totaux / pertes totales
                    </p>
                </div>
            </div>
        </div>
        
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 text-center p-3">
                <div class="card-body">
                    <i class="fas fa-chart-area fa-3x text-danger mb-3"></i>
                    <h5 class="card-title">Drawdown Max</h5>
                    <p class="card-text text-muted">
                        Perte maximale depuis un pic
                    </p>
                </div>
            </div>
        </div>
        
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 text-center p-3">
                <div class="card-body">
                    <i class="fas fa-coins fa-3x text-primary mb-3"></i>
                    <h5 class="card-title">Intérêts composés</h5>
                    <p class="card-text text-muted">
                        Calcul de la croissance réelle
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- CALL TO ACTION FINAL -->
<section class="bg-gradient-primary text-white py-5 my-5" style="border-radius: var(--border-radius-xl);">
    <div class="container">
        <div class="row justify-content-center text-center">
            <div class="col-lg-8">
                <h2 class="display-6 fw-bold mb-3">
                    Prêt à optimiser votre trading ?
                </h2>
                <p class="lead mb-4">
                    Rejoignez des milliers de traders qui utilisent déjà notre plateforme 
                    pour améliorer leurs performances et maximiser leurs profits.
                </p>
                <div class="d-flex flex-column flex-sm-row justify-content-center gap-3">
                    {% if current_user.is_authenticated %}
                        <a href="{{ url_for('upload_files') }}" class="btn btn-light btn-lg">
                            <i class="fas fa-rocket me-2"></i>
                            Commencer maintenant
                        </a>
                    {% else %}
                        <a href="{{ url_for('auth.register') }}" class="btn btn-light btn-lg">
                            <i class="fas fa-user-plus me-2"></i>
                            S'inscrire gratuitement
                        </a>
                        <a href="{{ url_for('auth.login') }}" class="btn btn-outline-light btn-lg">
                            <i class="fas fa-sign-in-alt me-2"></i>
                            Se connecter
                        </a>
                    {% endif %}
                    <button class="btn btn-outline-light btn-lg" data-bs-toggle="modal" data-bs-target="#contactModal">
                        <i class="fas fa-envelope me-2"></i>
                        Nous contacter
                    </button>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- MODAL DÉMO -->
<div class="modal fade" id="demoModal" tabindex="-1" aria-labelledby="demoModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="demoModalLabel">
                    <i class="fas fa-play-circle me-2"></i>Démonstration de l'analyseur
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="text-center mb-4">
                    <h4 class="mb-3">
                        <i class="fas fa-play-circle text-primary me-2"></i>
                        Découvrez l'analyseur en action
                    </h4>
                    <p class="lead text-muted">
                        Apprenez à utiliser toutes les fonctionnalités de notre plateforme d'analyse de trading.
                    </p>
                </div>
                
                <!-- Vidéo de démonstration -->
                <div class="ratio ratio-16x9 mb-4" style="border-radius: 10px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
                    <video controls class="w-100" style="object-fit: cover;">
                        <source src="{{ url_for('static', filename='demo_video.mp4') }}" type="video/mp4">
                        <div class="d-flex align-items-center justify-content-center h-100 bg-light">
                            <div class="text-center">
                                <i class="fas fa-exclamation-triangle fa-3x text-warning mb-3"></i>
                                <p>Votre navigateur ne supporte pas la lecture vidéo HTML5.</p>
                                <a href="{{ url_for('static', filename='demo_video.mp4') }}" class="btn btn-primary" download>
                                    <i class="fas fa-download me-2"></i>Télécharger la vidéo
                                </a>
                            </div>
                        </div>
                    </video>
                </div>
                
                <div class="row text-center">
                    <div class="col-md-4">
                        <i class="fas fa-upload fa-2x text-primary mb-2"></i>
                        <h6>Import facile</h6>
                        <small class="text-muted">Glissez-déposez vos fichiers</small>
                    </div>
                    <div class="col-md-4">
                        <i class="fas fa-cogs fa-2x text-success mb-2"></i>
                        <h6>Traitement automatique</h6>
                        <small class="text-muted">Analyse en temps réel</small>
                    </div>
                    <div class="col-md-4">
                        <i class="fas fa-download fa-2x text-warning mb-2"></i>
                        <h6>Rapport instantané</h6>
                        <small class="text-muted">Export Excel complet</small>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-times me-2"></i>Fermer
                </button>
                <a href="{{ url_for('upload_files') }}" class="btn btn-primary">
                    <i class="fas fa-rocket me-2"></i>Essayer maintenant
                </a>
            </div>
        </div>
    </div>
</div>

<!-- MODAL CONTACT -->
<div class="modal fade" id="contactModal" tabindex="-1" aria-labelledby="contactModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="contactModalLabel">
                    <i class="fas fa-envelope me-2"></i>Nous contacter
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="contactForm">
                <div class="modal-body">
                    <div class="text-center mb-4">
                        <i class="fas fa-headset fa-3x text-primary mb-3"></i>
                        <h5 class="mb-2">Contactez notre équipe</h5>
                        <p class="text-muted">
                            Nous vous répondrons dans les plus brefs délais
                        </p>
                    </div>

                    <div class="row g-3">
                        <div class="col-md-6">
                            <label for="contactPrenom" class="form-label">Prénom <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="contactPrenom" name="prenom" required>
                        </div>
                        <div class="col-md-6">
                            <label for="contactNom" class="form-label">Nom <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="contactNom" name="nom" required>
                        </div>
                        <div class="col-12">
                            <label for="contactEmail" class="form-label">Email <span class="text-danger">*</span></label>
                            <input type="email" class="form-control" id="contactEmail" name="email" required>
                        </div>
                        <div class="col-12">
                            <label for="contactSubject" class="form-label">Sujet</label>
                            <select class="form-select" id="contactSubject" name="subject">
                                <option value="">Sélectionnez un sujet</option>
                                <option value="support">Support technique</option>
                                <option value="question">Question générale</option>
                                <option value="bug">Signaler un bug</option>
                                <option value="feature">Demande de fonctionnalité</option>
                                <option value="other">Autre</option>
                            </select>
                        </div>
                        <div class="col-12">
                            <label for="contactMessage" class="form-label">Message <span class="text-danger">*</span></label>
                            <textarea class="form-control" id="contactMessage" name="message" rows="4" required placeholder="Décrivez votre demande ou votre problème..."></textarea>
                        </div>
                    </div>

                    <!-- Messages de statut -->
                    <div id="contactStatus" class="mt-3" style="display: none;">
                        <div id="contactLoading" class="alert alert-info" style="display: none;">
                            <i class="fas fa-spinner fa-spin me-2"></i>
                            Envoi en cours...
                        </div>
                        <div id="contactSuccess" class="alert alert-success" style="display: none;">
                            <i class="fas fa-check-circle me-2"></i>
                            Message envoyé avec succès ! Nous vous répondrons bientôt.
                        </div>
                        <div id="contactError" class="alert alert-danger" style="display: none;">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            <span id="contactErrorText">Une erreur est survenue. Veuillez réessayer.</span>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Annuler
                    </button>
                    <button type="submit" class="btn btn-primary" id="contactSubmitBtn">
                        <i class="fas fa-paper-plane me-2"></i>Envoyer
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Pourquoi nous choisir -->
<section class="why-choose-us py-5">
    <div class="container">
        <h2 class="section-title text-center mb-5">{{ t('home.why_choose_us.title') }}</h2>
        <div class="row">
            <div class="col-md-4">
                <div class="feature-card animate-fade-in-up">
                    <div class="feature-icon">
                        <i class="fas fa-tachometer-alt"></i>
                    </div>
                    <h3 class="feature-title">{{ t('home.why_choose_us.feature_1_title') }}</h3>
                    <p class="feature-text">
                        {{ t('home.why_choose_us.feature_1_desc') }}
                    </p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="feature-card animate-fade-in-up">
                    <div class="feature-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h3 class="feature-title">{{ t('home.why_choose_us.feature_2_title') }}</h3>
                    <p class="feature-text">
                        {{ t('home.why_choose_us.feature_2_desc') }}
                    </p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="feature-card animate-fade-in-up">
                    <div class="feature-icon">
                        <i class="fas fa-file-excel"></i>
                    </div>
                    <h3 class="feature-title">{{ t('home.why_choose_us.feature_3_title') }}</h3>
                    <p class="feature-text">
                        {{ t('home.why_choose_us.feature_3_desc') }}
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="how-it-works py-5">
    <div class="container">
        <h2 class="section-title text-center mb-5">{{ t('home.how_it_works.title') }}</h2>
        <div class="row">
            <div class="col-md-4">
                <div class="feature-card animate-fade-in-up">
                    <div class="feature-icon">
                        <i class="fas fa-upload"></i>
                    </div>
                    <h3 class="feature-title">{{ t('home.how_it_works.step_1_title') }}</h3>
                    <p class="feature-text">
                        {{ t('home.how_it_works.step_1_desc') }}
                    </p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="feature-card animate-fade-in-up">
                    <div class="feature-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h3 class="feature-title">{{ t('home.how_it_works.step_2_title') }}</h3>
                    <p class="feature-text">
                        {{ t('home.how_it_works.step_2_desc') }}
                    </p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="feature-card animate-fade-in-up">
                    <div class="feature-icon">
                        <i class="fas fa-file-excel"></i>
                    </div>
                    <h3 class="feature-title">{{ t('home.how_it_works.step_3_title') }}</h3>
                    <p class="feature-text">
                        {{ t('home.how_it_works.step_3_desc') }}
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_scripts %}
<!-- Animation on scroll -->
<script>
    // Animation au scroll pour les éléments
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };
    
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.animationDelay = Math.random() * 0.3 + 's';
                entry.target.classList.add('animate-fade-in-up');
                observer.unobserve(entry.target);
            }
        });
    }, observerOptions);
    
    // Observer tous les éléments avec la classe d'animation
    document.addEventListener('DOMContentLoaded', () => {
        const animatedElements = document.querySelectorAll('.animate-fade-in-up');
        animatedElements.forEach(el => {
            observer.observe(el);
        });
    });

    // Gestion du formulaire de contact
    document.getElementById('contactForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const submitBtn = document.getElementById('contactSubmitBtn');
        const statusDiv = document.getElementById('contactStatus');
        const loadingDiv = document.getElementById('contactLoading');
        const successDiv = document.getElementById('contactSuccess');
        const errorDiv = document.getElementById('contactError');
        const errorText = document.getElementById('contactErrorText');
        
        // Masquer tous les messages de statut
        statusDiv.style.display = 'none';
        loadingDiv.style.display = 'none';
        successDiv.style.display = 'none';
        errorDiv.style.display = 'none';
        
        // Afficher le loading
        statusDiv.style.display = 'block';
        loadingDiv.style.display = 'block';
        submitBtn.disabled = true;
        
        // Collecter les données du formulaire
        const formData = new FormData(this);
        
        try {
            const response = await fetch('/contact', {
                method: 'POST',
                body: formData
            });
            
            const result = await response.json();
            
            loadingDiv.style.display = 'none';
            
            if (response.ok && result.success) {
                successDiv.style.display = 'block';
                this.reset(); // Réinitialiser le formulaire
                
                // Fermer le modal après 2 secondes
                setTimeout(() => {
                    const modal = bootstrap.Modal.getInstance(document.getElementById('contactModal'));
                    modal.hide();
                    statusDiv.style.display = 'none';
                    successDiv.style.display = 'none';
                }, 2000);
            } else {
                errorText.textContent = result.message || 'Une erreur est survenue. Veuillez réessayer.';
                errorDiv.style.display = 'block';
            }
        } catch (error) {
            loadingDiv.style.display = 'none';
            errorText.textContent = 'Erreur de connexion. Vérifiez votre connexion internet.';
            errorDiv.style.display = 'block';
        }
        
        submitBtn.disabled = false;
    });

    // Réinitialiser le formulaire quand le modal se ferme
    document.getElementById('contactModal').addEventListener('hidden.bs.modal', function() {
        document.getElementById('contactForm').reset();
        document.getElementById('contactStatus').style.display = 'none';
    });
</script>
{% endblock %} 